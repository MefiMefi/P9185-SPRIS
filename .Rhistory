rownames(output_delta) <- c()
#Output
output_formatted_delta =
cbind(delta_inputs, output_delta) %>%
select(-term) %>%
mutate(across(c("estimate":"std.error"), round, 3),
#across(c("statistic":"df", "Y_mean":"Y_sd"), round, 2),
p.value = round(p.value, digits = 2))
output_formatted_delta %>%
dplyr::select(delta_inputs, estimate, std.error, p.value, Y_mean, Y_sd) %>%
knitr::kable(booktabs = T, escape = F, digits = 2, col.names = c("$\\delta$", "${\\widehat{\\beta}}_4$", "SD", "p-value", "Mean of outcome (after imputation)", "SD of outcome (after imputation)"), caption = "Estimated treatment effect of treatment C using imputed data with different $\\delta$ value.")
model.ipw.coxph.1 <- geeglm(mem_comp_delta ~ day_fct + treatment_group + age + gender , data = data.comp %>% filter(day > 0) %>% mutate(day_fct = factor(day_fct,levels = c(5,19,90))), family = gaussian, id = subject_id, corstr = "independence", weights = 1/prob.stay.coxph)
model.ipw.coxph.1 <- geeglm(mem_comp_delta ~ day_fct + treatment_group + age + gender , data = data.comp %>% filter(day > 0) %>% mutate(day_fct = factor(day_fct,levels = c(5,19,90))), family = gaussian, id = subject_id, corstr = "independence", weights = 1/prob.stay.coxph)
model.ipw.coxph.1 <- geeglm(mem_comp_delta ~ day_fct + treatment_group + age + gender , data = data.comp %>% filter(day > 0) %>% mutate(day_fct = factor(day_fct,levels = c(5,19,90))), family = gaussian, id = subject_id, corstr = "independence", weights = 1/prob.stay.coxph)
source(knitr::purl("./EDA.Rmd", quiet=TRUE))
source(knitr::purl("./stat_analysis.Rmd", quiet=TRUE))
source(knitr::purl("./EDA.Rmd", quiet=TRUE))
source(knitr::purl("./stat_analysis.Rmd", quiet=TRUE))
source(knitr::purl("./EDA.Rmd", quiet=TRUE))
source(knitr::purl("./stat_analysis.Rmd", quiet=TRUE))
knitr::opts_chunk$set(echo = FALSE, message = F, warning = F)
library(visdat)
library(mice)
library(VIM)
library(lattice)
library(ggplot2)
library(miceadds)
library(formattable)
library(graphics)
include_graphics("./plots/Screenshot 2024-03-25 102531.png")
table1( ~ gender + age + mem_comp | treatment_group, data=data.baseline, render.continuous=my.render.cont, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktabs = TRUE) %>%  kable_styling(latex_options = c("hold_position", "scale_down"))
traj.plot + traj.change.plot
mean.score.plot <-
data.comp %>%
group_by(subject_id) %>%
mutate(total_obs = sum(as.numeric(observed))) %>%
ungroup() %>%
mutate(type = as.factor(ifelse(total_obs == 4, "Completer", "Drop-out"))) %>%
group_by(type, day_fct, treatment_group) %>%
mutate(mean_mem_comp = mean(mem_comp,na.rm = T)) %>%
dplyr::select(day_fct, treatment_group, type, mean_mem_comp) %>%
distinct() %>%
ungroup() %>%
ggplot(aes(x = day_fct, y = mean_mem_comp, group = interaction(treatment_group, type), color = treatment_group, linetype = type)) +
geom_line(alpha = 0.8, size = 0.5) +
scale_linetype_manual(values = c("Completer" = "solid", "Drop-out" = "dashed")) +
labs(color = "Treatment Group", linetype = "Type") +
ylab("Composite memory score")+
xlab("Days of observation")+
theme_bw()+
theme(legend.position = "none")
mean.score.change.plot <-
data.comp %>%
filter(day > 0) %>%
mutate(day_fct = factor(day_fct, levels = c(5,19,90))) %>%
group_by(subject_id) %>%
mutate(total_obs = sum(as.numeric(observed))) %>%
ungroup() %>%
mutate(type = as.factor(ifelse(total_obs == 3, "Completer", "Drop-out"))) %>%
group_by(type, day_fct, treatment_group) %>%
mutate(mean_mem_comp = mean(mem_comp_delta,na.rm = T)) %>%
dplyr::select(day_fct, treatment_group, type, mean_mem_comp) %>%
distinct() %>%
ungroup() %>%
ggplot(aes(x = day_fct, y = mean_mem_comp, group = interaction(treatment_group, type), color = treatment_group, linetype = type)) +
geom_line(alpha = 0.8, size = 0.5) +
scale_linetype_manual(values = c("Completer" = "solid", "Drop-out" = "dashed")) +
labs(color = "Treatment Group", linetype = "Type") +
ylab("Change of composite memory score")+
xlab("Days of observation")+
theme_bw()
mean.score.plot + mean.score.change.plot
surv.curv <- stay.plot$plot + ylab("Proportion of stay in the study")
surv.bar <- stay.plot$ncensor.plot + ylab("Number of subjects") + theme(legend.position = "none")
surv.curv / surv.bar
tbl_merge(list(model.complete.delta.1.tbl, model.complete.delta.2.tbl, model.complete.delta.3.tbl), tab_spanner = c("Independent","AR-1","Exchangable")) %>% as_kable(booktabs = T,escape = FALSE , caption = "Coefficent estimates of the treatment effects from complete-case analysis, with different working covariance structures.") %>%  kable_styling(latex_options = c("hold_position", "scale_down")) %>% add_header_above(c(" ", "Independent" = 3, "AR-1" = 3, "Exchangable" = 3))
tbl_regression(model.prob.drop.coxph, exponentiate = T,label = list(
#day_fct ~ "Days",
treatment_group ~ "Treatment",
age ~ "Age",
gender ~ "Gender"
)) %>%
modify_header(
update = list(p.value = "p-value", ci = "$95\\%$ CI", label = "Characteristics", estimate = "HR")
)  %>% as_kable(booktabs = T,escape = FALSE, caption = "Coefficent estimates of the dropout risk model.") %>%  kable_styling(latex_options = c("hold_position"))
output_formatted_delta %>%
dplyr::select(delta_inputs, estimate, std.error, p.value, Y_mean, Y_sd) %>%
knitr::kable(booktabs = T, escape = F, digits = 2, col.names = c("$\\delta$", "${\\widehat{\\beta}}_4$", "SD", "p-value", "Mean of outcome (after imputation)", "SD of outcome (after imputation)"), caption = "Estimated treatment effect of treatment C using imputed data with different $\\delta$ value.")
delta_MNAR_f = function(delta){
MAR_step = mice(data.comp, m=5, method = "pmm", quickpred(data.comp, exc = "observed"), seed = 20)
MNAR_conversion_delta =
complete(MAR_step, action='long', include=TRUE) %>%
mutate(mem_comp = ifelse(observed == 0, mem_comp + delta, mem_comp))
MNAR_conversion_delta <- MNAR_conversion_delta %>%
arrange(.imp, subject_id, day) %>%
group_by(.imp, subject_id) %>%
mutate(baseline_mem_comp = first(mem_comp)) %>%
mutate(mem_comp_delta = mem_comp - baseline_mem_comp, na.rm = T)
MNAR_conversion_delta <- MNAR_conversion_delta %>% filter(day > 0)%>% mutate(day_fct = factor(day_fct, levels = c(5,19,90)))
MNAR_data_delta = as.mids(MNAR_conversion_delta)
# output_delta =
#   with(MNAR_data_delta, geeglm(mem_comp ~ day_fct + treatment_group + age + gender + treatment_group * day_fct, family = gaussian, id = subject_id, corstr = "independence"))
output_delta =
with(MNAR_data_delta, geeglm(mem_comp_delta ~ day_fct + treatment_group + age + gender , family = gaussian, id = subject_id, corstr = "independence"))
params_delta =
summary(pool(output_delta)) %>%
filter(term == "treatment_groupC")
desc_delta = with(MNAR_data_delta, expr=c("Y_mean"=mean(mem_comp), "Y_sd"=stats::sd(mem_comp)))
desc_delta = withPool_MI(desc_delta) %>% as.data.frame() %>% t()
cbind(params_delta, desc_delta)
}
# Set range of plausible delta values
delta_inputs = c( -0.1, 0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8,0.9,1.0,1.1, 1.2, 1.5, 2, 5)
# Map output
output_delta =
map_df(delta_inputs, delta_MNAR_f)
rownames(output_delta) <- c()
#Output
output_formatted_delta =
cbind(delta_inputs, output_delta) %>%
select(-term) %>%
mutate(across(c("estimate":"std.error"), round, 3),
#across(c("statistic":"df", "Y_mean":"Y_sd"), round, 2),
p.value = round(p.value, digits = 2))
output_formatted_delta %>%
dplyr::select(delta_inputs, estimate, std.error, p.value, Y_mean, Y_sd) %>%
knitr::kable(booktabs = T, escape = F, digits = 2, col.names = c("$\\delta$", "${\\widehat{\\beta}}_4$", "SD", "p-value", "Mean of outcome (after imputation)", "SD of outcome (after imputation)"), caption = "Estimated treatment effect of treatment C using imputed data with different $\\delta$ value.")
delta_MNAR_f = function(delta){
MAR_step = mice(data.comp, m=5, method = "pmm", quickpred(data.comp, exc = "observed"), seed = 20)
MNAR_conversion_delta =
complete(MAR_step, action='long', include=TRUE) %>%
mutate(mem_comp = ifelse(observed == 0, mem_comp + delta, mem_comp))
MNAR_conversion_delta <- MNAR_conversion_delta %>%
arrange(.imp, subject_id, day) %>%
group_by(.imp, subject_id) %>%
mutate(baseline_mem_comp = first(mem_comp)) %>%
mutate(mem_comp_delta = mem_comp - baseline_mem_comp, na.rm = T)
MNAR_conversion_delta <- MNAR_conversion_delta %>% filter(day > 0)%>% mutate(day_fct = factor(day_fct, levels = c(5,19,90)))
MNAR_data_delta = as.mids(MNAR_conversion_delta)
# output_delta =
#   with(MNAR_data_delta, geeglm(mem_comp ~ day_fct + treatment_group + age + gender + treatment_group * day_fct, family = gaussian, id = subject_id, corstr = "independence"))
output_delta =
with(MNAR_data_delta, geeglm(mem_comp_delta ~ day_fct + treatment_group + age + gender , family = gaussian, id = subject_id, corstr = "independence"))
params_delta =
summary(pool(output_delta)) %>%
filter(term == "treatment_groupC")
desc_delta = with(MNAR_data_delta, expr=c("Y_mean"=mean(mem_comp), "Y_sd"=stats::sd(mem_comp)))
desc_delta = withPool_MI(desc_delta) %>% as.data.frame() %>% t()
cbind(params_delta, desc_delta)
}
# Set range of plausible delta values
delta_inputs = c(-0.3, -0.2,-0.1, 0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8,0.9,1.0,1.1, 1.2, 1.5, 2, 5)
# Map output
output_delta =
map_df(delta_inputs, delta_MNAR_f)
rownames(output_delta) <- c()
#Output
output_formatted_delta =
cbind(delta_inputs, output_delta) %>%
select(-term) %>%
mutate(across(c("estimate":"std.error"), round, 3),
#across(c("statistic":"df", "Y_mean":"Y_sd"), round, 2),
p.value = round(p.value, digits = 2))
output_formatted_delta %>%
dplyr::select(delta_inputs, estimate, std.error, p.value, Y_mean, Y_sd) %>%
knitr::kable(booktabs = T, escape = F, digits = 2, col.names = c("$\\delta$", "${\\widehat{\\beta}}_4$", "SD", "p-value", "Mean of outcome (after imputation)", "SD of outcome (after imputation)"), caption = "Estimated treatment effect of treatment C using imputed data with different $\\delta$ value.")
# Set range of plausible delta values
delta_inputs = c(-0.3, -0.2,-0.1, 0, 0.1, 0.5,
0.8, 1.2, 1.5, 2)
delta_MNAR_f = function(delta){
MAR_step = mice(data.comp, m=5, method = "pmm", quickpred(data.comp, exc = "observed"), seed = 20)
MNAR_conversion_delta =
complete(MAR_step, action='long', include=TRUE) %>%
mutate(mem_comp = ifelse(observed == 0, mem_comp + delta, mem_comp))
MNAR_conversion_delta <- MNAR_conversion_delta %>%
arrange(.imp, subject_id, day) %>%
group_by(.imp, subject_id) %>%
mutate(baseline_mem_comp = first(mem_comp)) %>%
mutate(mem_comp_delta = mem_comp - baseline_mem_comp, na.rm = T)
MNAR_conversion_delta <- MNAR_conversion_delta %>% filter(day > 0)%>% mutate(day_fct = factor(day_fct, levels = c(5,19,90)))
MNAR_data_delta = as.mids(MNAR_conversion_delta)
# output_delta =
#   with(MNAR_data_delta, geeglm(mem_comp ~ day_fct + treatment_group + age + gender + treatment_group * day_fct, family = gaussian, id = subject_id, corstr = "independence"))
output_delta =
with(MNAR_data_delta, geeglm(mem_comp_delta ~ day_fct + treatment_group + age + gender , family = gaussian, id = subject_id, corstr = "independence"))
params_delta =
summary(pool(output_delta)) %>%
filter(term == "treatment_groupC")
desc_delta = with(MNAR_data_delta, expr=c("Y_mean"=mean(mem_comp), "Y_sd"=stats::sd(mem_comp)))
desc_delta = withPool_MI(desc_delta) %>% as.data.frame() %>% t()
cbind(params_delta, desc_delta)
}
# Set range of plausible delta values
delta_inputs = seq(-2,2,by = 0.3)
# Map output
output_delta =
map_df(delta_inputs, delta_MNAR_f)
rownames(output_delta) <- c()
#Output
output_formatted_delta =
cbind(delta_inputs, output_delta) %>%
select(-term) %>%
mutate(across(c("estimate":"std.error"), round, 3),
#across(c("statistic":"df", "Y_mean":"Y_sd"), round, 2),
p.value = round(p.value, digits = 2))
output_formatted_delta %>%
dplyr::select(delta_inputs, estimate, std.error, p.value, Y_mean, Y_sd) %>%
knitr::kable(booktabs = T, escape = F, digits = 2, col.names = c("$\\delta$", "${\\widehat{\\beta}}_4$", "SD", "p-value", "Mean of outcome (after imputation)", "SD of outcome (after imputation)"), caption = "Estimated treatment effect of treatment C using imputed data with different $\\delta$ value.")
output_formatted_delta %>%
dplyr::select(delta_inputs, estimate, std.error, p.value, Y_mean, Y_sd) %>%
knitr::kable(booktabs = T, escape = F, digits = 2, col.names = c("$\\delta$", "${\\widehat{\\beta}}_4$", "SD", "p-value", "Mean of outcome (after imputation)", "SD of outcome (after imputation)"), caption = "Estimated treatment effect of treatment C using imputed data with different $\\delta$ value.")
data.imp <- complete(imp, "long", inc = TRUE)
## Graph
imp <- mice(data.comp, m = 5)
?mice
tbl_merge(list(model.ipw.coxph.1.tbl, model.ipw.coxph.2.tbl, model.ipw.coxph.3.tbl), tab_spanner = c("Independent","AR-1","Exchangable")) %>% as_kable(booktabs = T, escape = FALSE) %>%  kable_styling(latex_options = c("hold_position", "scale_down")) %>% add_header_above(c(" ", "Independent" = 3, "AR-1" = 3, "Exchangable" = 3))
model.complete.delta.1 <- geeglm(mem_comp_delta ~ day_fct + treatment_group + age + gender , data = data.comp %>% filter(type=="Completer", day > 0) %>% mutate(day_fct = factor(day_fct, levels = c(5,19,90))), family = gaussian, id = subject_id, corstr = "independence")
model.complete.delta.2 <- geeglm(mem_comp_delta ~ day_fct + treatment_group + age + gender , data = data.comp %>% filter(type=="Completer", day > 0) %>% mutate(day_fct = factor(day_fct, levels = c(5,19,90))), family = gaussian, id = subject_id,  corstr = "ar1")
model.complete.delta.3 <- geeglm(mem_comp_delta ~ day_fct + treatment_group + age + gender, data = data.comp %>% filter(type=="Completer", day > 0) %>% mutate(day_fct = factor(day_fct, levels = c(5,19,90))), family = gaussian, id = subject_id, corstr = "exchangeable")
model.complete.delta.1.tbl <- tbl_regression(model.complete.delta.1,label = list(
day_fct ~ "Days",
treatment_group ~ "Treatment",
age ~ "Age",
gender ~ "Gender"
#`day_fct:treatment_group` ~ "Days*Treatment"
)) %>% modify_header(list(p.value = "p-value", ci = "$95\\%$ CI", label = "Characteristics", estimate = "$\\widehat\\beta$"))
model.complete.delta.2.tbl <- tbl_regression(model.complete.delta.2,label = list(
day_fct ~ "Days",
treatment_group ~ "Treatment",
age ~ "Age",
gender ~ "Gender"
#`day_fct:treatment_group` ~ "Days*Treatment"
)) %>%
modify_header(
update = list(p.value = "p-value", ci = "$95\\%$ CI", label = "Characteristics", estimate = "$\\widehat\\beta$")
)
model.complete.delta.3.tbl <- tbl_regression(model.complete.delta.3,label = list(
day_fct ~ "Days",
treatment_group ~ "Treatment",
age ~ "Age",
gender ~ "Gender"
#`day_fct:treatment_group` ~ "Days*Treatment"
)) %>%
modify_header(
update = list(p.value = "p-value", ci = "$95\\%$ CI", label = "Characteristics", estimate = "$\\widehat\\beta$")
)
model.complete.delta.tbl <-
tbl_merge(list(model.complete.delta.1.tbl, model.complete.delta.2.tbl, model.complete.delta.3.tbl), tab_spanner = c("Independent","AR-1","Exchangable")) %>% as_kable(booktabs = T, format = "latex",escape = FALSE) %>%  kable_styling(latex_options = c("hold_position")) %>% add_header_above(c(" ", "Independent" = 3, "AR-1" = 3, "Exchangable" = 3))
model.complete.delta.tbl
writeLines(as.character(model.complete.delta.tbl), "complete_case_gee_delta.tex")
table1( ~ gender + age + mem_comp | treatment_group, data=data.baseline, render.continuous=my.render.cont, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktabs = TRUE) %>%  kable_styling(latex_options = c("hold_position", "scale_down"))
tbl_merge(list(model.complete.delta.1.tbl, model.complete.delta.2.tbl, model.complete.delta.3.tbl), tab_spanner = c("Independent","AR-1","Exchangable")) %>% as_kable(booktabs = T,escape = FALSE , caption = "Coefficent estimates of the treatment effects from complete-case analysis, with different working covariance structures.") %>%  kable_styling(latex_options = c("hold_position", "scale_down")) %>% add_header_above(c(" ", "Independent" = 3, "AR-1" = 3, "Exchangable" = 3))
model.complete.tbl
tbl_regression(model.drop, exponentiate = F)
model.drop <-
geeglm(just_dropped ~ day_fct + treatment_group + age + gender + mem_comp_lag, data = data.comp.lag, family = binomial, id = subject_id, corstr = "independence")
tbl_regression(model.drop, exponentiate = F)
data.comp.lag <-
data.comp.lag %>%
group_by(subject_id) %>%
mutate(just_dropped = ifelse((drop == 1 & lag(drop) == 0) | (drop == 1 & is.na(lag(drop))) , 1, 0)) %>%
ungroup()
model.drop <-
geeglm(just_dropped ~ day_fct + treatment_group + age + gender, data = data.comp.lag, family = binomial, id = subject_id, corstr = "independence")
tbl_regression(model.drop, exponentiate = F)
model.drop <-
geeglm(just_dropped ~ day_fct + treatment_group + age + gender, data = data.comp.lag, family = binomial, id = subject_id, corstr = "independence")
tbl_regression(model.drop, exponentiate = F)
tbl_regression(model.drop, exponentiate = T,label = list(
day_fct ~ "Days",
age ~ "Age",
gender ~ "Gender"
)) %>%
modify_header(
update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "OR")
)  %>% as_kable(booktabs = T, ,escape = FALSE) %>%  kable_styling(latex_options = c("hold_position"))
tbl_regression(model.drop, exponentiate = T,label = list(
day_fct ~ "Days",
age ~ "Age",
gender ~ "Gender"
)) %>%
modify_header(
update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "OR")
)  %>% as_kable(booktabs = T ,escape = FALSE) %>%  kable_styling(latex_options = c("hold_position"))
getwd()
pwd()
setwd("F:/PhD in Biostatistics/Coursework/Spring 2024/P9185 SPRIS/Project 3")
knitr::opts_chunk$set(echo = FALSE, message = F, warning = F)
source(knitr::purl("./project3_analysis.Rmd", quiet=TRUE))
library(knitr)
library(kableExtra)
library(table1)
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktabs = TRUE) %>%  kable_styling(latex_options = c("hold_position", "scale_down"))
View(meno.dat)
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.")
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.")
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktabs = TRUE)
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktab = TRUE)
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktabs = TRUE)
library(htmltools)
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktabs = TRUE)
knitr::opts_chunk$set(echo = TRUE)
#pacman::p_load(tidyverse, plotly, shiny, scales, patchwork, DiagrammeR,
survival, KMsurv, flexsurv, eha, ctqr, cmprsk, mstate, ggsurvfit, survminer,
knitr::opts_chunk$set(echo = FALSE, message = F, warning = F)
source(knitr::purl("./project3_analysis.Rmd", quiet=TRUE))
library(knitr)
library(kableExtra)
library(table1)
library(htmltools)
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktabs = TRUE)
library(table1)
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktabs = TRUE)
knitr::opts_chunk$set(echo = FALSE, message = F, warning = F)
source(knitr::purl("./project3_analysis.Rmd", quiet=TRUE))
??theme_set()
library(table1)
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktabs = TRUE)
knitr::opts_chunk$set(echo = FALSE, message = F, warning = F)
source(knitr::purl("./project3_analysis.Rmd", quiet=TRUE))
library(table1)
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.") %>% t1kable(booktabs = TRUE)
??wrap_plots
knitr::opts_chunk$set(echo = TRUE)
ggsurvplot(km.fit, data = meno.dat, conf.int = TRUE, risk.table = T)$plot
knitr::opts_chunk$set(echo = FALSE, message = F, warning = F)
source(knitr::purl("./project3_analysis.Rmd", quiet=TRUE))
library(knitr)
library(kableExtra)
library(table1)
table1( ~ intake_age + race + education | menopause, data=meno.dat, caption="Descriptive statistics of baseline characteristics of the 47 subjects by treatment groups.")
km.fit
ggsurvplot(km.fit, data = meno.dat, conf.int = TRUE, risk.table = T)
ggsurvplot(km.fit, data = meno.dat, conf.int = TRUE, risk.table = T, legend = "none")
ggsurvplot(km.fit, data = meno.dat, conf.int = TRUE, risk.table = T, legend = "none", ylab = "a")
?ggsurvplot
ggsurvplot(km.fit, data = meno.dat, conf.int = TRUE, risk.table = T, legend = "none", xlab = "Time to menopause (years)")
ggsurvplot(exp.fit, xlab = "Time to menopause (years)", censor = F)
ggsurvplot(exp.fit, xlab = "Time to menopause (years)", censor = F, legend = "none")
ggsurvplot(exp.fit, xlab = "Time to menopause (years)", censor = F, legend = "none", color = 2)
ggsurvplot(exp.fit, xlab = "Time to menopause (years)", censor = F, legend = "none", color = 3)
ggsurvplot(exp.fit, xlab = "Time to menopause (years)", censor = F, legend = F, color = 3)
ggsurvplot(exp.fit, xlab = "Time to menopause (years)", censor = F, legend = "none", color = 3)
plot(exp.fit, xlab = "Time to menopause (years)", censor = F, legend = "none")
plot(km.fit)
ggsurvplot(km.fit, data = meno.dat, conf.int = TRUE, risk.table = T, legend = "none", xlab = "Time to menopause (years)")
ggsurvplot(exp.fit)
ggsurvplot(exp.fit, risk.table = T)
ggsurvplot(exp.fit, risk.table = T, conf.int = T)
View(exp.fit)
View(km.fit)
p.exp <- ggsurvplot(exp.fit, risk.table = T, conf.int = T, )
View(p.exp)
p.exp$plot
p.exp$data.survplot
p.exp$table
View(p.exp)
View(coxph.fit)
library(gtsummary)
tbl_regression(coxph.fit)
tbl_regression(coxph.fit, exponentiate = T)
tbl_regression(coxph.fit, exponentiate = T)
library(gtsummary)
tbl_regression(coxph.fit, exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
))
tbl_regression(coxph.fit, exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
)) %>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "OR"))
Characteristics
tbl_regression(coxph.fit, exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
)) %>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR"))
tbl_regression(coxph.fit, exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
)) %>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
modify_labels()
tbl_regression(coxph.fit, exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
)) %>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
%>% as_kable(booktabs = T, format = "latex",escape = FALSE) %>%  kable_styling(latex_options = c("hold_position"))
tbl_regression(coxph.fit, exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
)) %>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
as_kable(booktabs = T, format = "latex",escape = FALSE) %>%  kable_styling(latex_options = c("hold_position"))
wrap_plots(cloglog.race$plot, cloglog.educ$plot)
cloglog.race$plot / cloglog.educ$plot
cloglog.race$plot / cloglog.educ$plot
cloglog.race$plot / cloglog.educ$plot
cloglog.race$plot / cloglog.educ$plot
cloglog.race$plot / cloglog.educ$plot
ggcoxzph(ph.test)
ggcoxzph(ph.test, ylab = "Residuals")
ggcoxzph(ph.test, ylab = "Residuals", digits = 3)
ggcoxzph(ph.test, ylab = "Residuals")
ggcoxzph(round(ph.test), ylab = "Residuals")
View(ph.test)
ph.test
ggcoxzph(ph.test, ylab = "Residuals")
cox.schoenfeld <- ggcoxzph(ph.test, ylab = "Residuals")
View(cox.schoenfeld)
cox.schoenfeld <- ggcoxzph(ph.test, ylab = "Residuals")+
annotate("text", x = x_position, y = y_position, label = sprintf("%.3f", p_value))
cox.schoenfeld$1
cox.schoenfeld[[1]]
View(cox.schoenfeld)
cox.schoenfeld[[1]]  +
ggtitle("s")
cox.schoenfeld[[1]]  +
ggtitle()
cox.schoenfeld[[1]]
cox.schoenfeld[[2]]
cox.schoenfeld[[2]] + ggtitle("Schoenfeld individual test p-value: 0.713")
cox.schoenfeld[[3]]
cox.schoenfeld[[3]] + ggtitle("Schoenfeld individual test p-value: 0.504")
cox.schoenfeld <- ggcoxzph(ph.test, ylab = "Residuals")
cox.sch.1 <- cox.schoenfeld[[1]] + ggtitle("Schoenfeld individual test p-value: 0.782")
cox.sch.2 <- cox.schoenfeld[[2]] + ggtitle("Schoenfeld individual test p-value: 0.713")
cox.sch.3 <- cox.schoenfeld[[3]] + ggtitle("Schoenfeld individual test p-value: 0.504")
?wrap_plots
ggcoxzph(ph.test, ylab = "Residuals")
cox.sch.1/ cox.sch.2 / cox.sch.3 + plot_annotation(title = 'My Combined Plot Title')
ggcoxzph(ph.test, ylab = "Residuals")
cox.schoenfeld <- ggcoxzph(ph.test, ylab = "Residuals")
cox.sch.1 <- cox.schoenfeld[[1]] + ggtitle("Schoenfeld individual test p-value: 0.782") + xlab("Time to menopause (years)")
cox.sch.2 <- cox.schoenfeld[[2]] + ggtitle("Schoenfeld individual test p-value: 0.713") + xlab("Time to menopause (years)")
cox.sch.3 <- cox.schoenfeld[[3]] + ggtitle("Schoenfeld individual test p-value: 0.504") + xlab("Time to menopause (years)")
cox.sch.1/ cox.sch.2 / cox.sch.3 + plot_annotation(title = 'Global Schoenfeld test p-value: 0.922')
ggsurvplot(exp.fit.left , xlab = "Time to menopause (years)", censor = F)
ggsurvplot(exp.fit.left , xlab = "Time to menopause (years)", censor = F, conf.int = T)
ggsurvplot(exp.fit.left , xlab = "Menopause Age (years)", censor = F)
ggsurvplot(exp.fit.left , xlab = "Menopause Age (years)", censor = F, risk.table = T)
ggsurvplot(exp.fit.left , xlab = "Menopause Age (years)", censor = F, risk.table = T, legend = "none")
ggsurvplot(exp.fit.left , xlab = "Menopause Age (years)", censor = F, risk.table = T, legend.position = "none")
ggsurvplot(exp.fit.left , xlab = "Menopause Age (years)", censor = F, risk.table = T)$plot
ggsurvplot(exp.fit.left , xlab = "Menopause Age (years)", censor = F, risk.table = T)
ggsurvplot(km.fit.left.race, data = meno.dat, pval.method = TRUE, conf.int = TRUE, censor = F, risk.table = T, legend.labs = c("White, non-Hispanic", "Black, non-Hispanic", "Other Ethnicity"), legend.title = "Race")
km.fit.left.race
km.fit.left.race
ggsurvplot(km.fit.left.race, data = meno.dat, pval.method = TRUE, conf.int = TRUE, censor = F, risk.table = T, legend.labs = c("White, non-Hispanic", "Black, non-Hispanic", "Other Ethnicity"), legend.title = "Race")
ggsurvplot(km.fit.left.race, data = meno.dat, pval.method = TRUE, conf.int = TRUE, censor = F, risk.table = T,tables.height = 0.4,legend.labs = c("White, non-Hispanic", "Black, non-Hispanic", "Other Ethnicity"), legend.title = "Race")
ggsurvplot(km.fit.left.race, data = meno.dat, pval.method = TRUE, conf.int = TRUE, censor = F, risk.table = T,tables.height = 0.3,legend.labs = c("White, non-Hispanic", "Black, non-Hispanic", "Other Ethnicity"), legend.title = "Race")
coxph.fit.race.educ %>% tbl_regression(exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
)%>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
as_kable(booktabs = T, format = "latex",escape = FALSE) %>%  kable_styling(latex_options = c("hold_position")))
coxph.fit.race.educ %>% tbl_regression(.,exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
)%>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
as_kable(booktabs = T, format = "latex",escape = FALSE) %>%  kable_styling(latex_options = c("hold_position")))
coxph.fit.race.educ %>% tbl_regression(.,exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
))%>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
as_kable(booktabs = T, format = "latex",escape = FALSE) %>%  kable_styling(latex_options = c("hold_position")))
coxph.fit.race.educ %>% tbl_regression(.,exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
))%>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
as_kable(booktabs = T, format = "latex",escape = FALSE) %>%  kable_styling(latex_options = c("hold_position"))
coxph.fit.race.educ %>% tbl_regression(.,exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
))%>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
as_kable(booktabs = T, format = "latex",escape = FALSE) %>%  kable_styling(latex_options = c("hold_position"))
coxph.fit.race.educ %>% tbl_regression(.,exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level"
))%>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
as_kable(booktabs = T, format = "latex",escape = FALSE) %>%  kable_styling(latex_options = c("hold_position"))
tbl_regression(coxph.fit, exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level",
`intake_age` ~ "Age at enrollment"
)) %>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
as_kable(booktabs = T, escape = FALSE) %>%  kable_styling(latex_options = c("hold_position"))
coxph.fit.race.educ %>% tbl_regression(.,exponentiate = T, label = list(
race ~ "Race",
education ~ "Education level"
))%>%
modify_header( update = list(p.value = "p-value", ci = "95% CI", label = "Characteristics", estimate = "HR")) %>%
as_kable(booktabs = T, escape = FALSE) %>%  kable_styling(latex_options = c("hold_position"))
