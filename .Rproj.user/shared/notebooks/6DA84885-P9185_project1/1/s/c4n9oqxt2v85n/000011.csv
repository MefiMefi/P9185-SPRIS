"0","# 0- baseline; 1- 1st treatment; 2- 1st wash out; 3- 2nd treatment;"
"0","# 4- 2nd wash out; 5- third treatment; 6- third wash out"
"0",""
"0","endpoints.PK <-"
"0","  baseline.dat %>% "
"0","  select(ptid, bviral0:sviral6) %>% "
"0","  mutate("
"0","    dbvial1 = -bviral1 - bviral0,"
"0","    dsvial1 = -sviral1 - sviral0,"
"0","    dbvial2 = -bviral3 - bviral2,"
"0","    dsvial2 = -sviral3 - sviral2,"
"0","    dbvial3 = -bviral5 - bviral4,"
"0","    dsvial3 = -sviral5 - sviral4"
"0","  ) %>% "
"0","  pivot_longer("
"0","    cols = starts_with(""d""),"
"0","    names_to = c(""measure"", ""period""),"
"0","    names_pattern = ""d(.*vial)(\\d+)"","
"0","    values_to = ""dvalue"""
"0","  ) %>% "
"0","  select(ptid, measure, period, dvalue) %>% "
"0","  mutate(period = as.numeric(period),"
"0","         dvalue = -dvalue) "
"0","  "
"0",""
"0","traj.PK <-"
"0","  endpoints.PK %>% "
"0","  ggplot(aes(x = period, y = dvalue, group = measure)) +"
"0","  geom_smooth(method = ""lm"", se = FALSE, show.legend = FALSE) +"
"0","  geom_line(alpha = 0.2, aes(group = factor(ptid))) + "
"0","  geom_point(alpha = 0.1, size = 0.8) +"
"0","  facet_wrap(vars(measure), scales = ""free_y"")"
"0",""
"0",""
"0","traj.PK"
